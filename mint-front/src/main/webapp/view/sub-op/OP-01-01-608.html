<!--
	Screen ID : OP-01-01-608
	Screen NM : 한국감정원(KAB) 온라인 전문이력 조회
-->

<!--location -->
<div class="row wrapper border-bottom white-bg page-heading">
    <div id="oldPath" class="col-lg-5" style="display:none;">
		<h2><lb class="lb-630">운영환경</lb></h2>
		<ol class="breadcrumb">
			<li><lb class="lb-29"></lb></li>
			<li><lb class="lb-30"></lb></li>
			<li class="active"><strong><lb class="lb-630">운영환경</lb></strong></li>
		</ol>
    </div>
    <div id="menuPath" class="col-lg-5">
		<h2><lb class="lb-630">운영환경</lb></h2>
		<ol class="breadcrumb">
			<li><lb class="lb-29"></lb></li>
			<li><lb class="lb-30"></lb></li>
			<li class="active"><strong><lb class="lb-630">운영환경</lb></strong></li>
		</ol>
    </div>
    <!--button-->
    <div class="col-lg-7">
        <div class="title-action">

        </div>
    </div>
    <!--button end-->
</div>
<!--location end-->
<!--wrapper wrapper-content-->
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5><lb class="lb-78"></lb></h5>
                    &nbsp;&nbsp;&nbsp;
                    <div class="ibox-tools">
                       <a class="help-over-pannel" onclick="mint.ui.help(this, 'AP00000016','H001')"></a>
					   <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </div>
					<div style="float: right; padding: 0px 20px 0px 0px;">
						<a class="btn btn-w-m btn-default btn-outline btn-clear"><i class="fa fa-check "></i> <lb class="lb-79"></lb></a>
						<a class="btn btn-w-m btn-default btn-outline btn-search"><i class="fa fa-search "></i> <lb class="lb-10"></lb> </a>
						<a class="btn btn-w-m btn-default btn-outline btn-dashboard" style="display: none;"><i class="fa fa-reply"></i> <lb class="lb-31"></lb></a>
					</div>
                </div>
                <div class="ibox-content">
                    <div class="row">

                        <div class="col-sm-4">
                            <div class="form-group">
                                <span class="label-tag-4"><lb class="lb-895">Global ID</lb></span>
                                <input id="messageManageNo" class="input-tag-4 k-textbox" type="text" placeholder="Search...">
                            </div>
                        </div>

                        <div class="col-sm-4">
                            <div class="form-group">
                                <span class="label-tag-4"><lb class="lb-822">기관코드</lb></span>
                                <input id="insttCode" class="input-tag-4 k-textbox" type="text" placeholder="Search...">
                            </div>
                        </div>

                        <div class="col-sm-4">
                            <div class="form-group">
                                <span class="label-tag-4"><lb class="lb-683">거래구분코드</lb></span>
                                <input id="delngSeCode" class="input-tag-4 k-textbox" type="text" placeholder="Search...">
                            </div>
                        </div>

                        <hr class="hr-space">

                        <div class="col-sm-4 unregistered-div">
                            <div class="form-group">
                                <span class="label-tag-4"><lb class="lb-473">상태</lb></span>
								<span style="padding: 0px 0px 0px 0px;">
					            	<div class="radio radio-inline" style="padding-left:20px; padding-top:5px;">
										<span class="radio-info" style="padding-right: 10px;">
											<input id="status-flag-all" type="radio" name="status-flag" value=""><label for="status-flag-all"><lb class="lb-89">전체</lb></label>
										</span>
		                                <span class="radio-danger" style="padding:0px 20px;">
		                                	<input id="status-flag-timeout" type="radio" name="status-flag" value="1" checked="checked"><label for="status-flag-timeout"><lb class="lb-680">TIMEOUT</lb></label>
		                                </span>
                                	</div>
                                </span>
                            </div>
                        </div>

                        <div class="col-sm-4">
                            <div class="form-group">
                                <span class="label-tag-4"><lb class="lb-418"></lb><lb class="lb-494"></lb></span>
                                <input id="manageSe" class="input-tag-4 k-textbox" type="text" placeholder="Search...">
                            </div>
                        </div>

                        <div class="col-sm-4">
                            <div class="form-group">
                                <span class="label-tag-4"><lb class="lb-686">응답코드</lb></span>
                                <input id="responseCode" class="input-tag-4 k-textbox" type="text" placeholder="Search...">
                            </div>
                        </div>

                        <hr class="hr-space">

 						<div class="col-sm-12" style="padding-top: 0px">
							<div class="b-col"></div>
						</div>
                        <hr class="hr-space">

                        <div class="col-sm-4">
                            <div class="form-group">
                                <span class="label-tag-4"><lb class="lb-302"></lb>(From)</span>
                                <input id="fromDate" class="input-tag-4" style="text-align:center;">
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group">
                             	<span class="label-tag-4"><lb class="lb-302"></lb>(To)</span>
								<input id="toDate" class="input-tag-4" style="text-align:center;">
                            </div>
                        </div>
                    </div>
                </div>
                <!--ibox-content end-->
            </div>
            <!--ibox float-e-margins end-->
        </div>
        <!--col-lg-12 end-->
    </div>
    <!--row end-->

    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5><lb class="lb-91"></lb></h5>
                    <div class="ibox-tools">
                       <a class="help-over-pannel" onclick="mint.ui.help(this, 'AP00000016','H002')"></a>
					   <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </div>
                </div>
                <div class="ibox-content">
					<div id="grid-messageLog"></div>
					<div id="grid-messageLog-excel" style="display:none;"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
$(document).ready(function() {
    //=======================================================================
    //(1) function 및 variable scope 설정 :: (메인은 main, 팝업 및 서브는 sub)
    //=======================================================================
    screenName = "OP-01-01-608";

    $.extend({
        main : {
            //=======================================================================
            // (2) Screen 에서 사용할 variable 정의
            //=======================================================================
			//-----------------------------------------------------------------------
			// [페이지 관련] - Page Control Variable
			//-----------------------------------------------------------------------
			page : 1,
			perCount : 1,
			totalCount : 0,
			//-----------------------------------------------------------------------
			// 조회 - 엑셀다운도드 조회조건 sync
			//-----------------------------------------------------------------------
			requestObject : new Object(),
			//-----------------------------------------------------------------------
			// etc
			//-----------------------------------------------------------------------
            searchNumInit: 1000,

            //=======================================================================
            // (3) Screen 에서 사용할 function 정의
            //=======================================================================

            //-----------------------------------------------------------------------
            // Description :: 화면 초기화
            //-----------------------------------------------------------------------
            fn_init : function() {
                try {
                    mint.init('$.main.fn_initCallback');
                } catch( e ) {
                    mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_init"});
                }
            },//end fn_init()

            //-----------------------------------------------------------------------
            // Description :: 화면 초기화 콜백
            //-----------------------------------------------------------------------
            fn_initCallback : function() {
                try{
                	mint.common.siteMenuPath(screenName);

                	//-----------------------------------------------------------------------
                	// DateTimePicker
                	//-----------------------------------------------------------------------
					var fromDate = new Date();
					fromDate.setHours(fromDate.getHours()-1,0,0,0);
					mint.ui.setDateTimePicker('fromDate', fromDate);

					var toDate = new Date();
					toDate.setHours(toDate.getHours(),59,59,0);
					mint.ui.setDateTimePicker('toDate', toDate);

                	//-----------------------------------------------------------------------
                	// Init grid
                	//-----------------------------------------------------------------------
                	$.main.fn_initGrid();

                	//-----------------------------------------------------------------------
                	// KeyEvent
                	//-----------------------------------------------------------------------
					$('#fromDate').keydown($.main.fn_onKeyDown);
					$('#toDate').keydown($.main.fn_onKeyDown);
					$('#messageManageNo').keydown($.main.fn_onKeyDown);
					$("#insttCode").keydown($.main.fn_onKeyDown);
                    $("#delngSeCode").keydown($.main.fn_onKeyDown);
                    $("#manageSe").keydown($.main.fn_onKeyDown);
                    $("#responseCode").keydown($.main.fn_onKeyDown);

					//-----------------------------------------------------------------------
					// [페이지 관련] - 그리드 페이지 컨트롤 이벤트 설정
					//-----------------------------------------------------------------------
					{
						var grid = $('#grid-messageLog').data('kendoGrid');
						var pager = grid.pager;
						pager.element.bind('change', function(e) {
							$.main.fn_gridItemPerPageEvent(e);
						});
						$.main.perCount = pager.pageSize();
					}

					//-----------------------------------------------------------------------
					// 대시보드 연계 확인
					//-----------------------------------------------------------------------
                    var caller = mint.common.getScreenParam("caller");
                    if( ! mint.common.isEmpty(caller) && caller == 'dashboard' ) {

                    	var options = mint.common.getScreenParam("options");

                   		$('.btn-dashboard').show();

    					var fromDate = new Date();
    					fromDate.setHours(0,0,0,0);

    					var toDate = new Date();
    					toDate.setHours(23,59,59,0);

    					$('#fromDate').data('kendoDateTimePicker').value(fromDate);
    					$('#toDate').data('kendoDateTimePicker').value(toDate);

    					if(!mint.common.isEmpty(options.status)) {
    						$('input:radio[name=status-flag]:input[value="1"]').prop('checked',true);
    					}

                    	$.main.fn_getData();

                    	{
                        	mint.common.setScreenParam("caller", null);
                        	mint.common.setScreenParam("option", null);
                    	}
                    }

                } catch( e ) {
                    mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_initCallback"});
                }
            },// end fn_initCallback

            //-----------------------------------------------------------------------
            // Description :: 검색 조건 초기화
            //-----------------------------------------------------------------------
            fn_clearSearchArea : function() {
                try {

					$('#messageManageNo').val('');
					$("#insttCode").val('');
                    $("#delngSeCode").val('');
                    $("#manageSe").val('');
                    $("#responseCode").val('');

                    // 상태
                    $('input:radio[name=status-flag]:input[value="1"]').prop('checked',true);

                    // 검색기간
					var fromDate = new Date();
					fromDate.setHours(fromDate.getHours()-1,0,0,0);
					$('#fromDate').data('kendoDateTimePicker').value(fromDate);

					var toDate = new Date();
					toDate.setHours(toDate.getHours(),59,59,0);
					$('#toDate').data('kendoDateTimePicker').value(toDate);

                } catch( e ) {
                    mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_clearSearchArea"});
                }
            },

            //-----------------------------------------------------------------------
            // Description :: request object 생성
            //-----------------------------------------------------------------------
            fn_getRequestObject : function(isInitSearch) {
                try{
                    var requestObject = new Object();
                    requestObject.insttCode = $("#insttCode").val(); // 기관코드
                    requestObject.delngSeCode = $("#delngSeCode").val(); // 거래구분코드
                    requestObject.manageSe = $("#manageSe").val(); // 관리구분
                    requestObject.messageManageNo = $("#messageManageNo").val(); // GLOBAL ID
                    requestObject.responseCode = $("#responseCode").val(); // 응답코드
                    requestObject.status = $('input[name=status-flag]:checked').val();

                    if( mint.common.isEmpty( $("#msgDateTime").val() ) ) {
                    	requestObject.startDate      = mint.common.formatDate($("#fromDate").data("kendoDateTimePicker").value(), 'yyyyMMddHHmm') + '00000000';
                    	requestObject.endDate        = mint.common.formatDate($("#toDate").data("kendoDateTimePicker").value(), 'yyyyMMddHHmm') + '59999999';
                    } else {
                    	requestObject.startDate      = $("#msgDateTime").val();
                    	requestObject.endDate        = $("#msgDateTime").val();
                    }

					//-----------------------------------------------------------------------
					// [페이지 관련] - page, perCount 설정
					//-----------------------------------------------------------------------
			    	if( isInitSearch ) {
			    		$.main.page = 1;
			    		requestObject.total = 0;
			    	} else {
			    		requestObject.total = $.main.totalCount;
			    	}

			    	requestObject.page     = $.main.page;
			    	requestObject.perCount = $.main.perCount;

			    	//-----------------------------------------------------------------------
			    	// ExcelDownload 시 참고할 requestObject
			    	//-----------------------------------------------------------------------
			    	$.main.requestObject = requestObject;

                    return requestObject;
                } catch( e ) {
                    mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_getRequestObject"});
                }
            },

            //-----------------------------------------------------------------------
            // Description :: 데이터 조회
            //-----------------------------------------------------------------------
            fn_getData : function(isInitSearch) {
                try{
                    mint.callService($.main.fn_getRequestObject(isInitSearch), screenName, 'REST-R01-OP-01-01-KAB', '$.main.fn_setGridData', {errorCall : true, includeRequest : true});
                } catch( e ) {
                    mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_getData"});
                }

            },

            //-----------------------------------------------------------------------
            // Description :: 데이터 조회 콜백
            //-----------------------------------------------------------------------
            fn_setGridData : function(requestObject, responseObject) {
            	try {
            		var dataSource = new kendo.data.DataSource({
						  data: responseObject
					    , page: $.main.page
					    , pageSize: $.main.perCount
					    , serverPaging: true
					    , schema: {
					    	total: function() {
					    		return ($.main.totalCount = requestObject.total);
					    	}
					    }
					});

					//데이터 재설정
					$("#grid-messageLog").data("kendoGrid").setDataSource(dataSource);

            	} catch(e) {
            		mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_setGridData"});
            	}
            },

			//-----------------------------------------------------------------------
			// Description :: Excel Data 조회
			//-----------------------------------------------------------------------
			fn_getGridExcelData : function() {
				try {
					$.main.requestObject.page     = 1;
					$.main.requestObject.perCount = $.main.totalCount;

			    	mint.callService($.main.requestObject, screenName, 'REST-R01-OP-01-01-KAB', '$.main.fn_setGridExcelData', {errorCall : true, includeRequest : false});
				} catch( e ) {
					mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_getGridExcelData"});
				}
			},//end fn_getGridExcelData()

			//-----------------------------------------------------------------------
			// Description :: 엑셀 저장용 그리드 데이터 바인딩
			//-----------------------------------------------------------------------
			fn_setGridExcelData : function(responseObject) {
				try {
					var dataSource = new kendo.data.DataSource({
						  data: responseObject
					    , page:1
					    , pageSize:mint.ui.getPageSizesL({'currentPage' : true})
					});

					var gridExcel = $("#grid-messageLog-excel").data("kendoGrid");
					gridExcel.setDataSource(dataSource);
				    gridExcel.saveAsExcel();

				} catch( e ) {
					mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_setGridExcelData"});
				}
			},//end fn_setGridExcelData()

            //-----------------------------------------------------------------------
			// Description ::  검색 결과 - Grid 생성
			//-----------------------------------------------------------------------
            fn_initGrid : function() {
            	try{
					//-----------------------------------------------------------------------
					// 조회 결과 그리드
					//-----------------------------------------------------------------------
	            	$("#grid-messageLog").kendoGrid({
	                    dataSource : {
		                    data : "",
		                    pageSize : mint.ui.getPageSizesL({'currentPage' : true})
	                    },
	                    filterable: true,
	                    resizable: true,
	                    sortable : true,
	                    scrollable : true,
	                	columnMenu: true,
						reorderable: true,
	                    pageable : {
	                      pageSizes     : mint.ui.getPageSizesL(),
	                      buttonCount   : 5,
	                      input : true
	                    },
	                    selectable : true,
	                    toolbar: ["excel"],
						excel: {
							  allPages: true
							, filterable: true
							, fileName: mint.common.remakeYYMMDD(new Date()).substring(0, 14) + '_' + mint.label.getLabel('lb-30') + '.xlsx'
						},
						messages: {
							commands: {
							  excel: mint.label.getLabel('lb-508')
							}
						},
					    page: function(e) {
					    	$.main.fn_gridPageEvent(e);
					    },
						excelExport: function(e) {
						    $.main.fn_getGridExcelData();
						    e.preventDefault();
						},
	                    columns : $.main.fn_getColumn_Grid(),
	                    dataBound: function (e) {
							if(1 > $("#grid-messageLog").data().kendoGrid.dataSource.view().length) {
								var gridHeight = window.innerHeight - ($('.navbar-static-top').height() + $('.page-heading').height() + $('.col-lg-12').height());

								$("#grid-messageLog").children(".k-grid-content").height(gridHeight /2.5);
								$("#grid-messageLog").children(".k-grid-content-locked").height(gridHeight / 2.5);
							} else {
								$("#grid-messageLog").children(".k-grid-content").height('auto');
								$("#grid-messageLog").children(".k-grid-content-locked").height('auto');
							}
						}
                    });

					//-----------------------------------------------------------------------
					// Excel export 그리드
					//-----------------------------------------------------------------------
	            	$("#grid-messageLog-excel").kendoGrid({
	                    dataSource : {
		                    data : "",
		                    pageSize : mint.ui.getPageSizesL({'currentPage' : true})
	                    },
	                    filterable: true,
	                    resizable: true,
	                    sortable : true,
	                    scrollable : true,
	                	columnMenu: true,
						reorderable: true,
	                    pageable : {
	                      pageSizes     : mint.ui.getPageSizesL(),
	                      buttonCount   : 5

	                    },
	                    selectable : true,
	                    toolbar: ["excel"],
						excel: {
							  allPages: true
							, filterable: true
							, fileName: mint.common.remakeYYMMDD(new Date()).substring(0, 14) + '_' + mint.label.getLabel('lb-30') + '.xlsx'
						},
						messages: {
							commands: {
							  excel: mint.label.getLabel('lb-508')
							}
						},
					    page: function(e) {
					    	$.main.fn_gridPageEvent(e);
					    },
						excelExport: function(e) {
							//-----------------------------------------------------------------------
					    	// 스타일 편집
					    	//-----------------------------------------------------------------------
					        var sheet = e.workbook.sheets[0];
					        for (var i = 0; i < sheet.rows.length; i++) {
					        	if( sheet.rows[i].type == 'header' ) {
						        	for (var ci = 0; ci < sheet.rows[i].cells.length; ci++) {
						            	sheet.rows[i].cells[ci].vAlign = "center";
					            		sheet.rows[i].cells[ci].hAlign = "center";
					            		sheet.rows[i].cells[ci].bold = true;
						        	}
					        	}
					    	}
						},
	                    columns : $.main.fn_getColumn_Grid(),
	                    dataBound: function (e) {}
                    });

            	} catch ( e ) {
            		mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_initGrid"});
            	}
            },


         	//-----------------------------------------------------------------------
			// Description :: - 그리드 컬럼 동적 설정
			//-----------------------------------------------------------------------
			fn_getColumn_Grid : function() {

				try{
					var fixLeftGridWidth = ($('#grid-messageLog')[0].clientWidth / 10) * 7;
					var fixLeftCoulmnWidth = fixLeftGridWidth / 4;
					var columnsData =
						[
							{
							    field : "status", // 상태
							    title : mint.label.getLabel('lb-473'),
							    width : "60px",
							    template : '#=$.main.fn_setColor(status)#',
							    headerAttributes : {
							        style : "text-align: center"
							    },
							    attributes : {
							        style : "text-align: center; white-space: nowrap;"
							    },
							    filterable: { multi: true, search: true }
							},
							{
							    field : "messageManageNo", // Global ID
							    title : mint.label.getLabel('lb-895'),
							    width : "150px",
							    template: "<span title='${messageManageNo}'>${messageManageNo}</span>",
							    headerAttributes : {
							        style : "text-align: center"
							    },
							    attributes : {
							        style : "text-align: center; white-space: nowrap;"
							    },
							    filterable: { multi: true, search: true }
							},
							{
		                        field : "insttCode", // 기관
		                        title : mint.label.getLabel('lb-820'),
		                        width : "120px",
		                        template: '#=$.main.fn_setOrgNm(insttCode)#',
		                        headerAttributes : {
		                            style : "text-align: center"
		                        },
		                        attributes : {
		                            style : "text-align: center; white-space: nowrap;"
		                        },
		                        filterable: { multi: true, search: true },
		                    },
		                    {
		                        field : "delngSeCode", // 거래구분코드
		                        title : mint.label.getLabel('lb-683'),
		                        width : "100px",
		                        template: "<span title='${delngSeCode}'>${delngSeCode}</span>",
		                        headerAttributes : {
		                            style : "text-align: center"
		                        },
		                        attributes : {
		                            style : "text-align: center; white-space: nowrap;"
		                        },
		                        filterable: { multi: true, search: true },
		                    },
		                    {
		                        field : "manageSe", // 관리구분
		                        title : mint.label.getLabel('lb-418') + mint.label.getLabel('lb-494'),
		                        width : "80px",
		                        template: "<span title='${manageSe}'>${manageSe}</span>",
		                        headerAttributes : {
		                            style : "text-align: center"
		                        },
		                        attributes : {
		                            style : "text-align: center; white-space: nowrap;"
		                        },
		                        filterable: { multi: true, search: true },
	 	                    },
		                    {
		                        field : "reqProcessDt", // 요청처리시간
		                        title : mint.label.getLabel('lb-684'),
		                        width : "200px",
		                        headerAttributes : {
		                            style : "text-align: center"
		                        },
		                        attributes : {
		                            style : "text-align: center; white-space: nowrap;"
		                        },
		                        filterable: { multi: true, search: true },
							},
						    {
						        field : "resProcessDt", // 응답 처리시간
						        title : mint.label.getLabel('lb-685'),
						        width : "200px",
						        headerAttributes : {
						            style : "text-align: center"
						        },
						        attributes : {
						            style : "text-align: center; white-space: nowrap;"
						        },
						        filterable: { multi: true, search: true }
						    },
					        {
		                        field : "responseCode", // 응답코드
		                        title : mint.label.getLabel('lb-686'),
		                        width : "100px",
		                        template: "<span title='${responseCode}'>${responseCode}</span>",
		                        headerAttributes : {
		                            style : "text-align: center"
		                        },
		                        attributes : {
		                            style : "text-align: center; white-space: nowrap;"
		                        },
		                        filterable: { multi: true, search: true }
		                    }
				 		];

					return columnsData;
				}
				catch(e) {
					mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "fn_getColumn_Grid"});
				}
			}, // end fn_getColumn_Grid()

			//-----------------------------------------------------------------------
			// Description :: [페이지 관련] - Grid Page Event
			//-----------------------------------------------------------------------
			fn_gridPageEvent : function(event) {
				try {
					$.main.page     = parseInt(event.page);
					$.main.perCount = parseInt(event.sender.pager.pageSize());
					$.main.fn_getData(false);
				} catch( e ) {
					mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "fn_gridPageEvent"});
				}
			},//end fn_gridPageEvent()

			//-----------------------------------------------------------------------
			// Description :: [페이지 관련] - Grid ItemPerPage Event
			//-----------------------------------------------------------------------
			fn_gridItemPerPageEvent : function(event) {
				try {
					var grid = $('#grid-messageLog').data('kendoGrid');
					if( $.main.perCount != grid.pager.pageSize() ) {
						$.main.perCount = grid.pager.pageSize();
						// 조회가 완료된 이후 페이지 값이 변경되면, 다시 조회하여 초기화 한다
						if( grid.dataSource.total() > 0 ) {
							$.main.fn_getData(true);
						}
					}
				} catch( e ) {
					mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "fn_gridItemPerPageEvent"});
				}
			},//end fn_gridItemPerPageEvent()


            //-----------------------------------------------------------------------
            // Description :: grid status color 변경
            //-----------------------------------------------------------------------
            fn_setColor : function(val) {
                try {
                    if (val && val != null && val == mint.label.getLabel('lb-680'))
                        return "<b style='color:red'>" + val + "</b>";
                    else if (val && val != null && val == mint.label.getLabel('lb-681'))
                        return "<b style='color:blue'>" + val + "</b>";
                    else if (val && val != null && val == mint.label.getLabel('lb-682'))
                        return "<b style='color:#f8ac5a'>" + val + "</b>";
                    else
                        return val;
                } catch( e ) {
                    mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_setColor"});
                }
            },
            //-----------------------------------------------------------------------
            // Description :: grid 기관명 변경
            //-----------------------------------------------------------------------
            fn_setOrgNm : function(val) {
                try {
                    if (val && val != null && val == "003") {
                        return "<span title='기업은행'>기업은행("+val+")</span>";
                    } else if (val && val != null && val == "004") {
                    	return "<span title='국민은행'>국민은행("+val+")</span>";
                    } else if (val && val != null && val == "007") {
                    	return "<span title='수협은행'>수협은행("+val+")</span>";
                    } else if (val && val != null && val == "011") {
                    	return "<span title='농협은행'>농협은행("+val+")</span>";
                    } else if (val && val != null && val == "020") {
                    	return "<span title='우리은행'>우리은행("+val+")</span>";
                    } else if (val && val != null && val == "023") {
                    	return "<span title='SC제일은행'>SC제일은행("+val+")</span>";
                    } else if (val && val != null && val == "027") {
                    	return "<span title='한국씨티은행'>한국씨티은행("+val+")</span>";
                    } else if (val && val != null && val == "031") {
                    	return "<span title='대구은행'>대구은행("+val+")</span>";
                    } else if (val && val != null && val == "032") {
                    	return "<span title='부산은행'>부산은행("+val+")</span>";
                    } else if (val && val != null && val == "034") {
                    	return "<span title='광주은행'>광주은행("+val+")</span>";
                    } else if (val && val != null && val == "037") {
                    	return "<span title='전북은행'>전북은행("+val+")</span>";
                    } else if (val && val != null && val == "035") {
                    	return "<span title='제주은행'>제주은행("+val+")</span>";
                    } else if (val && val != null && val == "039") {
                    	return "<span title='경남은행'>경남은행("+val+")</span>";
                    } else if (val && val != null && val == "081") {
                    	return "<span title='KEB하나은행'>KEB하나은행("+val+")</span>";
                    } else if (val && val != null && val == "088") {
                    	return "<span title='신한은행'>신한은행("+val+")</span>";
                    } else {
                        return val;
                    }
                } catch( e ) {
                    mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_setOrgNm"});
                }
            },
          	//-----------------------------------------------------------------------
            // Description :: grid 클릭 시 상세 팝업 오픈
            //-----------------------------------------------------------------------
            fn_showDetailPopup : function() {

                try {
                    var grid = $("#grid-messageLog").data("kendoGrid");
                    var selectedItem = grid.dataItem(grid.select());

                    var env = mint.common.getEnvorinment();
            		var isDecrypt = env['tracking.detail.message.isDecrypt'];

            		if( !mint.common.isEmpty(isDecrypt) && isDecrypt[0] === 'Y' ) {
            			selectedItem.isDecrypt = "Y";
            		} else {
            			selectedItem.isDecrypt = "N";
            		}

                    mint.common.setScreenParam('detailKey', selectedItem);
    				mint.common.searchPopup('../sub-co/CO-01-00-612.html','CO-01-00-612'); // IM-02-06-501

                } catch( e ) {
                    mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_showDetailPopup"});
                }
            },

          	//-----------------------------------------------------------------------
			// Description :: 엔터키 이벤트
			//-----------------------------------------------------------------------
			fn_onKeyDown : function(event) {
				try {
					if(event.keyCode == 13) {
						$.main.fn_getData(true);
					}
				}
				catch(e) {
					mint.common.errorLog(e, {"screenName" : screenName, "fnName" : "$.main.fn_onKeyDown"});
				}
			} // end fn_onKeyDown
        }
    });


    //=======================================================================
    // (4) 이벤트 핸들러 정의
    //=======================================================================

	//-----------------------------------------------------------------------
	// Description :: 조회 버튼 Click 이벤트
	//-----------------------------------------------------------------------
    $('.btn-search').on('click', function() {
        $.main.fn_getData(true);
    });

  //-----------------------------------------------------------------------
	// Description :: 대시보드 back 버튼 Click 이벤트
	//-----------------------------------------------------------------------
	$(".btn-dashboard").bind("click", function () {
		mint.move('../sub-op/OP-02-00-602');
	});

	//-----------------------------------------------------------------------
	// Description :: 초기화 버튼 Click 이벤트
	//-----------------------------------------------------------------------
    $('.btn-clear').on('click', function() {
        $.main.fn_clearSearchArea();
    });

  //-----------------------------------------------------------------------
	// Description :: 그리드 Double Click 이벤트 (상세 조회)
	//-----------------------------------------------------------------------
    $('#grid-messageLog').on("dblclick", "table", function(e) {
        $.main.fn_showDetailPopup();
    });

    //=======================================================================
    // (5) 기타 Function 정의
    //=======================================================================


    //=======================================================================
    // (6) 화면 로딩시 실행할 항목 기술
    //=======================================================================
    $.main.fn_init();
    mint.label.attachLabel(null);

});
</script>
