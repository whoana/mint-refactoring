<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="pep.per.mint.database.mapper.su.StatisticsMapperKICS">
	<!--
  	<cache/>
  	-->

	<sql id="period-innerJoin-total-interface1">
		<if test="scCategory != null and (scCategory eq 'interface'.toString())">
		INNER JOIN
		(
			SELECT
				  A.INTEGRATION_ID
				, A.INTERFACE_NM
				, A.INTERFACE_ID
			FROM TAN0201 A
			<choose>
			<when test="isInterfaceAdmin != null and isInterfaceAdmin eq 'Y'.toString()">
			</when>
			<otherwise>
				INNER JOIN
				-----------------------------------------------
				-- 데이터 엑세스 권한 별 인터페이스 조회
				-----------------------------------------------
				(
					SELECT
						DISTINCT
						TSU0220.INTERFACE_ID
					FROM
						-----------------------------------------------
						-- 로그인 사용자 데이터 엑세스 권한 조회(공통)
						-----------------------------------------------
						(
							SELECT
								DISTINCT
								TSU0219.USER_ID   AS USER_ID,
								TSU0221.C_ROLE_ID AS ROLE_ID,
								TSU0221.DEPTH     AS DEPTH
							FROM
								(
									SELECT
										TSU0101.USER_ID,
										TSU0219.ROLE_ID
									FROM
										TSU0101 TSU0101
										INNER JOIN TSU0219 TSU0219 ON
											TSU0101.USER_ID = TSU0219.USER_ID
									WHERE
										1 = 1
										AND TSU0101.DEL_YN = 'N'
										AND TSU0101.USER_ID = #{userId}
								) TSU0219
									INNER JOIN TSU0221 TSU0221 ON
									TSU0219.ROLE_ID = TSU0221.P_ROLE_ID
							ORDER BY USER_ID, C_ROLE_ID
						) ACCESS_ROLE
						-----------------------------------------------
						-- 데이터 엑세스 권한 :: 인터페이스 맵핑 조인
						-----------------------------------------------
						INNER JOIN TSU0220 TSU0220 ON
							ACCESS_ROLE.ROLE_ID = TSU0220.ROLE_ID

					UNION

					-----------------------------------------------
					-- 로그인 사용자 본인이 등록한 인터페이스 목록 조회
					-----------------------------------------------
					SELECT
						INTERFACE_ID
					FROM
						TAN0201
					WHERE REG_USER = #{userId}
				) ACCESS_ROLE_INTF ON
					A.INTERFACE_ID = ACCESS_ROLE_INTF.INTERFACE_ID
			</otherwise>
			</choose>

			WHERE
				A.DEL_YN = 'N'
			<if test="scCategoryDetailNm != null and scCategoryDetailNm != ''">
				AND A.INTERFACE_NM like '%'||#{scCategoryDetailNm}||'%'
			</if>
			<if test="scCategoryDetailId != null and scCategoryDetailId != ''">
				AND A.INTEGRATION_ID like '%'||#{scCategoryDetailId}||'%'
			</if>

			AND EXISTS (
				SELECT 1
                FROM TAN0213 B
                WHERE B.INTERFACE_ID = A.INTERFACE_ID
                <if test="scSystemId != null and scSystemId != ''">
                AND B.SYSTEM_ID = #{scSystemId}
                </if>
                <if test="scNodeType != null and scNodeType != ''">
                AND B.NODE_TYPE = #{scNodeType}
                </if>
			)
		) B
		ON A.INTERFACE_ID = B.INTERFACE_ID
		</if>
	</sql>
	<select id="getStatisticsInterfacePeriodTotalsYears" resultType="java.util.Map">
		SELECT
  			B.INTEGRATION_ID,
			B.INTERFACE_NM,
			GUBUN,
  			YEAR2010,YEAR2011,YEAR2012,YEAR2013,YEAR2014,YEAR2015,YEAR2016,
  			YEAR2017,YEAR2018,YEAR2019,YEAR2020,YEAR2021,YEAR2022,YEAR2023,
			YEAR2024,YEAR2025,YEAR2026,YEAR2027,YEAR2028,YEAR2029,YEAR2030,YEAR_SUM AS TOTAL_SUM
		FROM (
	    	SELECT
         		INTERFACE_ID
         		, '1' AS SEQ
				, 'FINISHED' AS GUBUN
		        , SUM(CASE WHEN RANGE1='2010' THEN TOTAL_CNT ELSE 0 END) AS YEAR2010
		        , SUM(CASE WHEN RANGE1='2011' THEN TOTAL_CNT ELSE 0 END) AS YEAR2011
		        , SUM(CASE WHEN RANGE1='2012' THEN TOTAL_CNT ELSE 0 END) AS YEAR2012
		        , SUM(CASE WHEN RANGE1='2013' THEN TOTAL_CNT ELSE 0 END) AS YEAR2013
		        , SUM(CASE WHEN RANGE1='2014' THEN TOTAL_CNT ELSE 0 END) AS YEAR2014
		        , SUM(CASE WHEN RANGE1='2015' THEN TOTAL_CNT ELSE 0 END) AS YEAR2015
		        , SUM(CASE WHEN RANGE1='2016' THEN TOTAL_CNT ELSE 0 END) AS YEAR2016
		        , SUM(CASE WHEN RANGE1='2017' THEN TOTAL_CNT ELSE 0 END) AS YEAR2017
		        , SUM(CASE WHEN RANGE1='2018' THEN TOTAL_CNT ELSE 0 END) AS YEAR2018
		        , SUM(CASE WHEN RANGE1='2019' THEN TOTAL_CNT ELSE 0 END) AS YEAR2019
		        , SUM(CASE WHEN RANGE1='2020' THEN TOTAL_CNT ELSE 0 END) AS YEAR2020
		        , SUM(CASE WHEN RANGE1='2021' THEN TOTAL_CNT ELSE 0 END) AS YEAR2021
		        , SUM(CASE WHEN RANGE1='2022' THEN TOTAL_CNT ELSE 0 END) AS YEAR2022
		        , SUM(CASE WHEN RANGE1='2023' THEN TOTAL_CNT ELSE 0 END) AS YEAR2023
		        , SUM(CASE WHEN RANGE1='2024' THEN TOTAL_CNT ELSE 0 END) AS YEAR2024
		        , SUM(CASE WHEN RANGE1='2025' THEN TOTAL_CNT ELSE 0 END) AS YEAR2025
		        , SUM(CASE WHEN RANGE1='2026' THEN TOTAL_CNT ELSE 0 END) AS YEAR2026
		        , SUM(CASE WHEN RANGE1='2027' THEN TOTAL_CNT ELSE 0 END) AS YEAR2027
		        , SUM(CASE WHEN RANGE1='2028' THEN TOTAL_CNT ELSE 0 END) AS YEAR2028
		        , SUM(CASE WHEN RANGE1='2029' THEN TOTAL_CNT ELSE 0 END) AS YEAR2029
		        , SUM(CASE WHEN RANGE1='2030' THEN TOTAL_CNT ELSE 0 END) AS YEAR2030
		        , SUM(TOTAL_CNT) AS YEAR_SUM
			FROM (
        		SELECT
            		INTERFACE_ID
          			, SUBSTR(TR_MONTH,1,4) AS RANGE1
          			, SUM(COALESCE(SUCCESS_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0805
          		WHERE SUBSTR(TR_MONTH,1,4) BETWEEN '2010' AND '2030'
           		GROUP BY INTERFACE_ID, SUBSTR(TR_MONTH,1,4)
        	) FINISHED
      		GROUP BY INTERFACE_ID
        	UNION ALL
       		SELECT
         		INTERFACE_ID
         		, '3' AS SEQ
         		, 'ERROR'  AS GUBUN
         		, SUM(CASE WHEN RANGE1='2010' THEN TOTAL_CNT ELSE 0 END) AS YEAR2010
         		, SUM(CASE WHEN RANGE1='2011' THEN TOTAL_CNT ELSE 0 END) AS YEAR2011
         		, SUM(CASE WHEN RANGE1='2012' THEN TOTAL_CNT ELSE 0 END) AS YEAR2012
         		, SUM(CASE WHEN RANGE1='2013' THEN TOTAL_CNT ELSE 0 END) AS YEAR2013
         		, SUM(CASE WHEN RANGE1='2014' THEN TOTAL_CNT ELSE 0 END) AS YEAR2014
         		, SUM(CASE WHEN RANGE1='2015' THEN TOTAL_CNT ELSE 0 END) AS YEAR2015
         		, SUM(CASE WHEN RANGE1='2016' THEN TOTAL_CNT ELSE 0 END) AS YEAR2016
         		, SUM(CASE WHEN RANGE1='2017' THEN TOTAL_CNT ELSE 0 END) AS YEAR2017
         		, SUM(CASE WHEN RANGE1='2018' THEN TOTAL_CNT ELSE 0 END) AS YEAR2018
         		, SUM(CASE WHEN RANGE1='2019' THEN TOTAL_CNT ELSE 0 END) AS YEAR2019
         		, SUM(CASE WHEN RANGE1='2020' THEN TOTAL_CNT ELSE 0 END) AS YEAR2020
         		, SUM(CASE WHEN RANGE1='2021' THEN TOTAL_CNT ELSE 0 END) AS YEAR2021
         		, SUM(CASE WHEN RANGE1='2022' THEN TOTAL_CNT ELSE 0 END) AS YEAR2022
         		, SUM(CASE WHEN RANGE1='2023' THEN TOTAL_CNT ELSE 0 END) AS YEAR2023
         		, SUM(CASE WHEN RANGE1='2024' THEN TOTAL_CNT ELSE 0 END) AS YEAR2024
         		, SUM(CASE WHEN RANGE1='2025' THEN TOTAL_CNT ELSE 0 END) AS YEAR2025
         		, SUM(CASE WHEN RANGE1='2026' THEN TOTAL_CNT ELSE 0 END) AS YEAR2026
         		, SUM(CASE WHEN RANGE1='2027' THEN TOTAL_CNT ELSE 0 END) AS YEAR2027
         		, SUM(CASE WHEN RANGE1='2028' THEN TOTAL_CNT ELSE 0 END) AS YEAR2028
         		, SUM(CASE WHEN RANGE1='2029' THEN TOTAL_CNT ELSE 0 END) AS YEAR2029
         		, SUM(CASE WHEN RANGE1='2030' THEN TOTAL_CNT ELSE 0 END) AS YEAR2030
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          			, SUBSTR(TR_MONTH,1,4) AS RANGE1
          			, SUM(COALESCE(ERROR_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0805
          		WHERE SUBSTR(TR_MONTH,1,4) BETWEEN '2010' AND '2030'
           		GROUP BY INTERFACE_ID, SUBSTR(TR_MONTH,1,4)
        	) ERROR
      		GROUP BY INTERFACE_ID
    		UNION ALL
    		SELECT
         		INTERFACE_ID
         		, '2' AS SEQ
         		,'PROCESSING'  AS GUBUN
         		, SUM(CASE WHEN RANGE1='2010' THEN TOTAL_CNT ELSE 0 END) AS YEAR2010
         		, SUM(CASE WHEN RANGE1='2011' THEN TOTAL_CNT ELSE 0 END) AS YEAR2011
         		, SUM(CASE WHEN RANGE1='2012' THEN TOTAL_CNT ELSE 0 END) AS YEAR2012
         		, SUM(CASE WHEN RANGE1='2013' THEN TOTAL_CNT ELSE 0 END) AS YEAR2013
         		, SUM(CASE WHEN RANGE1='2014' THEN TOTAL_CNT ELSE 0 END) AS YEAR2014
         		, SUM(CASE WHEN RANGE1='2015' THEN TOTAL_CNT ELSE 0 END) AS YEAR2015
         		, SUM(CASE WHEN RANGE1='2016' THEN TOTAL_CNT ELSE 0 END) AS YEAR2016
         		, SUM(CASE WHEN RANGE1='2017' THEN TOTAL_CNT ELSE 0 END) AS YEAR2017
         		, SUM(CASE WHEN RANGE1='2018' THEN TOTAL_CNT ELSE 0 END) AS YEAR2018
         		, SUM(CASE WHEN RANGE1='2019' THEN TOTAL_CNT ELSE 0 END) AS YEAR2019
         		, SUM(CASE WHEN RANGE1='2020' THEN TOTAL_CNT ELSE 0 END) AS YEAR2020
         		, SUM(CASE WHEN RANGE1='2021' THEN TOTAL_CNT ELSE 0 END) AS YEAR2021
         		, SUM(CASE WHEN RANGE1='2022' THEN TOTAL_CNT ELSE 0 END) AS YEAR2022
         		, SUM(CASE WHEN RANGE1='2023' THEN TOTAL_CNT ELSE 0 END) AS YEAR2023
         		, SUM(CASE WHEN RANGE1='2024' THEN TOTAL_CNT ELSE 0 END) AS YEAR2024
         		, SUM(CASE WHEN RANGE1='2025' THEN TOTAL_CNT ELSE 0 END) AS YEAR2025
         		, SUM(CASE WHEN RANGE1='2026' THEN TOTAL_CNT ELSE 0 END) AS YEAR2026
         		, SUM(CASE WHEN RANGE1='2027' THEN TOTAL_CNT ELSE 0 END) AS YEAR2027
         		, SUM(CASE WHEN RANGE1='2028' THEN TOTAL_CNT ELSE 0 END) AS YEAR2028
         		, SUM(CASE WHEN RANGE1='2029' THEN TOTAL_CNT ELSE 0 END) AS YEAR2029
         		, SUM(CASE WHEN RANGE1='2030' THEN TOTAL_CNT ELSE 0 END) AS YEAR2030
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          			, SUBSTR(TR_MONTH,1,4) AS RANGE1
          			, SUM(COALESCE(PROCESS_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0805
          		WHERE SUBSTR(TR_MONTH,1,4) BETWEEN '2010' AND '2030'
           		GROUP BY INTERFACE_ID, SUBSTR(TR_MONTH,1,4)
        	) PROCESSING
      		GROUP BY  INTERFACE_ID
		) A
		<include refid="pep.per.mint.database.mapper.su.StatisticsMapperKICS.period-innerJoin-total-interface1"/>
  		ORDER BY B.INTERFACE_ID, B.INTERFACE_NM, A.SEQ
	</select>

	<select id="getStatisticsInterfacePeriodTotalsHour" resultType="java.util.Map">
		SELECT
  			B.INTEGRATION_ID,
  			B.INTERFACE_NM,
  			GUBUN,
  			HOUR1, HOUR2, HOUR3, HOUR4, HOUR5, HOUR6,
  			HOUR7, HOUR8, HOUR9, HOUR10, HOUR11, HOUR12,
  			HOUR13, HOUR14, HOUR15, HOUR16, HOUR17, HOUR18,
  			HOUR19, HOUR20, HOUR21, HOUR22, HOUR23, HOUR24,
  			YEAR_SUM AS TOTAL_SUM
		FROM (
    		SELECT
         		INTERFACE_ID
         		, '1' AS SEQ
         		, 'FINISHED' AS GUBUN
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'00' THEN TOTAL_CNT ELSE 0 END) AS HOUR1
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'01' THEN TOTAL_CNT ELSE 0 END) AS HOUR2
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'02' THEN TOTAL_CNT ELSE 0 END) AS HOUR3
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'03' THEN TOTAL_CNT ELSE 0 END) AS HOUR4
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'04' THEN TOTAL_CNT ELSE 0 END) AS HOUR5
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'05' THEN TOTAL_CNT ELSE 0 END) AS HOUR6
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'06' THEN TOTAL_CNT ELSE 0 END) AS HOUR7
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'07' THEN TOTAL_CNT ELSE 0 END) AS HOUR8
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'08' THEN TOTAL_CNT ELSE 0 END) AS HOUR9
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'09' THEN TOTAL_CNT ELSE 0 END) AS HOUR10
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'10' THEN TOTAL_CNT ELSE 0 END) AS HOUR11
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'11' THEN TOTAL_CNT ELSE 0 END) AS HOUR12
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'12' THEN TOTAL_CNT ELSE 0 END) AS HOUR13
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'13' THEN TOTAL_CNT ELSE 0 END) AS HOUR14
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'14' THEN TOTAL_CNT ELSE 0 END) AS HOUR15
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'15' THEN TOTAL_CNT ELSE 0 END) AS HOUR16
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'16' THEN TOTAL_CNT ELSE 0 END) AS HOUR17
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'17' THEN TOTAL_CNT ELSE 0 END) AS HOUR18
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'18' THEN TOTAL_CNT ELSE 0 END) AS HOUR19
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'19' THEN TOTAL_CNT ELSE 0 END) AS HOUR20
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'20' THEN TOTAL_CNT ELSE 0 END) AS HOUR21
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'21' THEN TOTAL_CNT ELSE 0 END) AS HOUR22
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'22' THEN TOTAL_CNT ELSE 0 END) AS HOUR23
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'23' THEN TOTAL_CNT ELSE 0 END) AS HOUR24
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          			, TR_DATE AS RANGE1
          			, SUM(COALESCE(SUCCESS_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0803
          		WHERE TR_DATE BETWEEN #{scPeriodFrom}||'00' AND #{scPeriodFrom}||'23'
           		GROUP BY INTERFACE_ID, TR_DATE
        	) FINISHED
      		GROUP BY INTERFACE_ID
        	UNION ALL
       		SELECT
         		INTERFACE_ID
         		, '3' AS SEQ
         		, 'ERROR' AS GUBUN
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'00' THEN TOTAL_CNT ELSE 0 END) AS HOUR1
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'01' THEN TOTAL_CNT ELSE 0 END) AS HOUR2
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'02' THEN TOTAL_CNT ELSE 0 END) AS HOUR3
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'03' THEN TOTAL_CNT ELSE 0 END) AS HOUR4
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'04' THEN TOTAL_CNT ELSE 0 END) AS HOUR5
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'05' THEN TOTAL_CNT ELSE 0 END) AS HOUR6
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'06' THEN TOTAL_CNT ELSE 0 END) AS HOUR7
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'07' THEN TOTAL_CNT ELSE 0 END) AS HOUR8
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'08' THEN TOTAL_CNT ELSE 0 END) AS HOUR9
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'09' THEN TOTAL_CNT ELSE 0 END) AS HOUR10
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'10' THEN TOTAL_CNT ELSE 0 END) AS HOUR11
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'11' THEN TOTAL_CNT ELSE 0 END) AS HOUR12
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'12' THEN TOTAL_CNT ELSE 0 END) AS HOUR13
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'13' THEN TOTAL_CNT ELSE 0 END) AS HOUR14
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'14' THEN TOTAL_CNT ELSE 0 END) AS HOUR15
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'15' THEN TOTAL_CNT ELSE 0 END) AS HOUR16
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'16' THEN TOTAL_CNT ELSE 0 END) AS HOUR17
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'17' THEN TOTAL_CNT ELSE 0 END) AS HOUR18
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'18' THEN TOTAL_CNT ELSE 0 END) AS HOUR19
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'19' THEN TOTAL_CNT ELSE 0 END) AS HOUR20
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'20' THEN TOTAL_CNT ELSE 0 END) AS HOUR21
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'21' THEN TOTAL_CNT ELSE 0 END) AS HOUR22
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'22' THEN TOTAL_CNT ELSE 0 END) AS HOUR23
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'23' THEN TOTAL_CNT ELSE 0 END) AS HOUR24
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          			, TR_DATE AS RANGE1
          			, SUM(COALESCE(ERROR_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0803
          		WHERE TR_DATE BETWEEN #{scPeriodFrom}||'00' AND #{scPeriodFrom}||'23'
           		GROUP BY INTERFACE_ID, TR_DATE
        	) ERROR
      		GROUP BY INTERFACE_ID
    		UNION ALL
    		SELECT
         		INTERFACE_ID
         		, '2' AS SEQ
         		,'PROCESSING'  AS GUBUN
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'00' THEN TOTAL_CNT ELSE 0 END) AS HOUR1
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'01' THEN TOTAL_CNT ELSE 0 END) AS HOUR2
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'02' THEN TOTAL_CNT ELSE 0 END) AS HOUR3
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'03' THEN TOTAL_CNT ELSE 0 END) AS HOUR4
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'04' THEN TOTAL_CNT ELSE 0 END) AS HOUR5
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'05' THEN TOTAL_CNT ELSE 0 END) AS HOUR6
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'06' THEN TOTAL_CNT ELSE 0 END) AS HOUR7
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'07' THEN TOTAL_CNT ELSE 0 END) AS HOUR8
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'08' THEN TOTAL_CNT ELSE 0 END) AS HOUR9
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'09' THEN TOTAL_CNT ELSE 0 END) AS HOUR10
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'10' THEN TOTAL_CNT ELSE 0 END) AS HOUR11
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'11' THEN TOTAL_CNT ELSE 0 END) AS HOUR12
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'12' THEN TOTAL_CNT ELSE 0 END) AS HOUR13
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'13' THEN TOTAL_CNT ELSE 0 END) AS HOUR14
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'14' THEN TOTAL_CNT ELSE 0 END) AS HOUR15
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'15' THEN TOTAL_CNT ELSE 0 END) AS HOUR16
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'16' THEN TOTAL_CNT ELSE 0 END) AS HOUR17
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'17' THEN TOTAL_CNT ELSE 0 END) AS HOUR18
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'18' THEN TOTAL_CNT ELSE 0 END) AS HOUR19
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'19' THEN TOTAL_CNT ELSE 0 END) AS HOUR20
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'20' THEN TOTAL_CNT ELSE 0 END) AS HOUR21
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'21' THEN TOTAL_CNT ELSE 0 END) AS HOUR22
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'22' THEN TOTAL_CNT ELSE 0 END) AS HOUR23
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(8))||'23' THEN TOTAL_CNT ELSE 0 END) AS HOUR24
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          			, TR_DATE AS RANGE1
          			, SUM(COALESCE(PROCESS_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0803
          		WHERE TR_DATE BETWEEN #{scPeriodFrom}||'00' AND #{scPeriodFrom}||'23'
           		GROUP BY INTERFACE_ID, TR_DATE
        	) PROCESSING
      		GROUP BY  INTERFACE_ID
      	) A
		<include refid="pep.per.mint.database.mapper.su.StatisticsMapperKICS.period-innerJoin-total-interface1"/>
  		ORDER BY B.INTERFACE_ID, B.INTERFACE_NM, A.SEQ
	</select>

	<select id="getStatisticsInterfacePeriodTotalsDay" resultType="java.util.Map">
		SELECT
  			B.INTEGRATION_ID,
  			B.INTERFACE_NM,
  			GUBUN,
  			DAY1, DAY2, DAY3, DAY4, DAY5, DAY6, DAY7, DAY8, DAY9, DAY10,
  			DAY11, DAY12, DAY13, DAY14, DAY15, DAY16, DAY17, DAY18, DAY19, DAY20,
  			DAY21, DAY22, DAY23, DAY24, DAY25, DAY26, DAY27, DAY28, DAY29, DAY30, DAY31,
  			YEAR_SUM AS TOTAL_SUM
		FROM (
    		SELECT
         		INTERFACE_ID
         		, '1' AS SEQ
         		, 'FINISHED' AS GUBUN
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'01' THEN TOTAL_CNT ELSE 0 END) AS DAY1
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'02' THEN TOTAL_CNT ELSE 0 END) AS DAY2
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'03' THEN TOTAL_CNT ELSE 0 END) AS DAY3
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'04' THEN TOTAL_CNT ELSE 0 END) AS DAY4
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'05' THEN TOTAL_CNT ELSE 0 END) AS DAY5
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'06' THEN TOTAL_CNT ELSE 0 END) AS DAY6
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'07' THEN TOTAL_CNT ELSE 0 END) AS DAY7
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'08' THEN TOTAL_CNT ELSE 0 END) AS DAY8
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'09' THEN TOTAL_CNT ELSE 0 END) AS DAY9
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'10' THEN TOTAL_CNT ELSE 0 END) AS DAY10
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'11' THEN TOTAL_CNT ELSE 0 END) AS DAY11
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'12' THEN TOTAL_CNT ELSE 0 END) AS DAY12
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'13' THEN TOTAL_CNT ELSE 0 END) AS DAY13
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'14' THEN TOTAL_CNT ELSE 0 END) AS DAY14
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'15' THEN TOTAL_CNT ELSE 0 END) AS DAY15
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'16' THEN TOTAL_CNT ELSE 0 END) AS DAY16
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'17' THEN TOTAL_CNT ELSE 0 END) AS DAY17
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'18' THEN TOTAL_CNT ELSE 0 END) AS DAY18
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'19' THEN TOTAL_CNT ELSE 0 END) AS DAY19
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'20' THEN TOTAL_CNT ELSE 0 END) AS DAY20
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'21' THEN TOTAL_CNT ELSE 0 END) AS DAY21
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'22' THEN TOTAL_CNT ELSE 0 END) AS DAY22
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'23' THEN TOTAL_CNT ELSE 0 END) AS DAY23
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'24' THEN TOTAL_CNT ELSE 0 END) AS DAY24
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'25' THEN TOTAL_CNT ELSE 0 END) AS DAY25
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'26' THEN TOTAL_CNT ELSE 0 END) AS DAY26
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'27' THEN TOTAL_CNT ELSE 0 END) AS DAY27
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'28' THEN TOTAL_CNT ELSE 0 END) AS DAY28
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'29' THEN TOTAL_CNT ELSE 0 END) AS DAY29
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'30' THEN TOTAL_CNT ELSE 0 END) AS DAY30
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'31' THEN TOTAL_CNT ELSE 0 END) AS DAY31
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          			, TR_DAY AS RANGE1
          			, SUM(COALESCE(SUCCESS_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0804
          		WHERE TR_DAY BETWEEN #{scPeriodFrom}||'01' AND #{scPeriodFrom}||'31'
           		GROUP BY INTERFACE_ID, TR_DAY
        	) FINISHED
      		GROUP BY INTERFACE_ID
        	UNION ALL
       		SELECT
         		INTERFACE_ID
         		, '3' AS SEQ
         		, 'ERROR'  AS GUBUN
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'01' THEN TOTAL_CNT ELSE 0 END) AS DAY1
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'02' THEN TOTAL_CNT ELSE 0 END) AS DAY2
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'03' THEN TOTAL_CNT ELSE 0 END) AS DAY3
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'04' THEN TOTAL_CNT ELSE 0 END) AS DAY4
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'05' THEN TOTAL_CNT ELSE 0 END) AS DAY5
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'06' THEN TOTAL_CNT ELSE 0 END) AS DAY6
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'07' THEN TOTAL_CNT ELSE 0 END) AS DAY7
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'08' THEN TOTAL_CNT ELSE 0 END) AS DAY8
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'09' THEN TOTAL_CNT ELSE 0 END) AS DAY9
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'10' THEN TOTAL_CNT ELSE 0 END) AS DAY10
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'11' THEN TOTAL_CNT ELSE 0 END) AS DAY11
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'12' THEN TOTAL_CNT ELSE 0 END) AS DAY12
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'13' THEN TOTAL_CNT ELSE 0 END) AS DAY13
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'14' THEN TOTAL_CNT ELSE 0 END) AS DAY14
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'15' THEN TOTAL_CNT ELSE 0 END) AS DAY15
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'16' THEN TOTAL_CNT ELSE 0 END) AS DAY16
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'17' THEN TOTAL_CNT ELSE 0 END) AS DAY17
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'18' THEN TOTAL_CNT ELSE 0 END) AS DAY18
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'19' THEN TOTAL_CNT ELSE 0 END) AS DAY19
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'20' THEN TOTAL_CNT ELSE 0 END) AS DAY20
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'21' THEN TOTAL_CNT ELSE 0 END) AS DAY21
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'22' THEN TOTAL_CNT ELSE 0 END) AS DAY22
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'23' THEN TOTAL_CNT ELSE 0 END) AS DAY23
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'24' THEN TOTAL_CNT ELSE 0 END) AS DAY24
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'25' THEN TOTAL_CNT ELSE 0 END) AS DAY25
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'26' THEN TOTAL_CNT ELSE 0 END) AS DAY26
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'27' THEN TOTAL_CNT ELSE 0 END) AS DAY27
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'28' THEN TOTAL_CNT ELSE 0 END) AS DAY28
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'29' THEN TOTAL_CNT ELSE 0 END) AS DAY29
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'30' THEN TOTAL_CNT ELSE 0 END) AS DAY30
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'31' THEN TOTAL_CNT ELSE 0 END) AS DAY31
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          			, TR_DAY AS RANGE1
          			, SUM(COALESCE(ERROR_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0804
          		WHERE TR_DAY BETWEEN #{scPeriodFrom}||'01' AND #{scPeriodFrom}||'31'
           		GROUP BY INTERFACE_ID, TR_DAY
        	) ERROR
      		GROUP BY  INTERFACE_ID
    		UNION ALL
    		SELECT
         		INTERFACE_ID
         		, '2' AS SEQ
         		,'PROCESSING' AS GUBUN
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'01' THEN TOTAL_CNT ELSE 0 END) AS DAY1
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'02' THEN TOTAL_CNT ELSE 0 END) AS DAY2
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'03' THEN TOTAL_CNT ELSE 0 END) AS DAY3
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'04' THEN TOTAL_CNT ELSE 0 END) AS DAY4
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'05' THEN TOTAL_CNT ELSE 0 END) AS DAY5
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'06' THEN TOTAL_CNT ELSE 0 END) AS DAY6
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'07' THEN TOTAL_CNT ELSE 0 END) AS DAY7
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'08' THEN TOTAL_CNT ELSE 0 END) AS DAY8
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'09' THEN TOTAL_CNT ELSE 0 END) AS DAY9
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'10' THEN TOTAL_CNT ELSE 0 END) AS DAY10
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'11' THEN TOTAL_CNT ELSE 0 END) AS DAY11
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'12' THEN TOTAL_CNT ELSE 0 END) AS DAY12
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'13' THEN TOTAL_CNT ELSE 0 END) AS DAY13
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'14' THEN TOTAL_CNT ELSE 0 END) AS DAY14
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'15' THEN TOTAL_CNT ELSE 0 END) AS DAY15
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'16' THEN TOTAL_CNT ELSE 0 END) AS DAY16
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'17' THEN TOTAL_CNT ELSE 0 END) AS DAY17
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'18' THEN TOTAL_CNT ELSE 0 END) AS DAY18
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'19' THEN TOTAL_CNT ELSE 0 END) AS DAY19
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'20' THEN TOTAL_CNT ELSE 0 END) AS DAY20
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'21' THEN TOTAL_CNT ELSE 0 END) AS DAY21
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'22' THEN TOTAL_CNT ELSE 0 END) AS DAY22
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'23' THEN TOTAL_CNT ELSE 0 END) AS DAY23
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'24' THEN TOTAL_CNT ELSE 0 END) AS DAY24
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'25' THEN TOTAL_CNT ELSE 0 END) AS DAY25
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'26' THEN TOTAL_CNT ELSE 0 END) AS DAY26
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'27' THEN TOTAL_CNT ELSE 0 END) AS DAY27
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'28' THEN TOTAL_CNT ELSE 0 END) AS DAY28
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'29' THEN TOTAL_CNT ELSE 0 END) AS DAY29
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'30' THEN TOTAL_CNT ELSE 0 END) AS DAY30
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(6))||'31' THEN TOTAL_CNT ELSE 0 END) AS DAY31
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          		, TR_DAY AS RANGE1
          		, SUM(COALESCE(PROCESS_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0804
          		WHERE TR_DAY BETWEEN #{scPeriodFrom}||'01' AND #{scPeriodFrom}||'31'
           		GROUP BY INTERFACE_ID, TR_DAY
        	) PROCESSING
      		GROUP BY INTERFACE_ID
      	) A
		<include refid="pep.per.mint.database.mapper.su.StatisticsMapperKICS.period-innerJoin-total-interface1"/>
  		ORDER BY B.INTERFACE_ID, B.INTERFACE_NM, A.SEQ
	</select>

	<select id="getStatisticsInterfacePeriodTotalsMonth" resultType="java.util.Map">
		SELECT
  			B.INTEGRATION_ID,
  			B.INTERFACE_NM,
  			GUBUN,
  			MONTH1, MONTH2, MONTH3, MONTH4, MONTH5, MONTH6,
  			MONTH7, MONTH8, MONTH9, MONTH10, MONTH11, MONTH12,
  			YEAR_SUM AS TOTAL_SUM
		FROM (
    		SELECT
        		 INTERFACE_ID
         		, '1' AS SEQ
         		, 'FINISHED' AS GUBUN
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'01' THEN TOTAL_CNT ELSE 0 END) AS MONTH1
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'02' THEN TOTAL_CNT ELSE 0 END) AS MONTH2
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'03' THEN TOTAL_CNT ELSE 0 END) AS MONTH3
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'04' THEN TOTAL_CNT ELSE 0 END) AS MONTH4
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'05' THEN TOTAL_CNT ELSE 0 END) AS MONTH5
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'06' THEN TOTAL_CNT ELSE 0 END) AS MONTH6
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'07' THEN TOTAL_CNT ELSE 0 END) AS MONTH7
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'08' THEN TOTAL_CNT ELSE 0 END) AS MONTH8
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'09' THEN TOTAL_CNT ELSE 0 END) AS MONTH9
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'10' THEN TOTAL_CNT ELSE 0 END) AS MONTH10
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'11' THEN TOTAL_CNT ELSE 0 END) AS MONTH11
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'12' THEN TOTAL_CNT ELSE 0 END) AS MONTH12
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          			, TR_MONTH AS RANGE1
          			, SUM(COALESCE(SUCCESS_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0805
          		WHERE TR_MONTH BETWEEN #{scPeriodFrom}||'01' AND #{scPeriodFrom}||'12'
				GROUP BY INTERFACE_ID, TR_MONTH
        	) FINISHED
      		GROUP BY INTERFACE_ID
        	UNION ALL
       		SELECT
        		 INTERFACE_ID
         		, '3' AS SEQ
         		, 'ERROR' AS GUBUN
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'01' THEN TOTAL_CNT ELSE 0 END) AS MONTH1
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'02' THEN TOTAL_CNT ELSE 0 END) AS MONTH2
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'03' THEN TOTAL_CNT ELSE 0 END) AS MONTH3
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'04' THEN TOTAL_CNT ELSE 0 END) AS MONTH4
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'05' THEN TOTAL_CNT ELSE 0 END) AS MONTH5
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'06' THEN TOTAL_CNT ELSE 0 END) AS MONTH6
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'07' THEN TOTAL_CNT ELSE 0 END) AS MONTH7
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'08' THEN TOTAL_CNT ELSE 0 END) AS MONTH8
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'09' THEN TOTAL_CNT ELSE 0 END) AS MONTH9
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'10' THEN TOTAL_CNT ELSE 0 END) AS MONTH10
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'11' THEN TOTAL_CNT ELSE 0 END) AS MONTH11
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'12' THEN TOTAL_CNT ELSE 0 END) AS MONTH12
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          			, TR_MONTH AS RANGE1
          			, SUM(COALESCE(ERROR_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0805
          		WHERE TR_MONTH BETWEEN #{scPeriodFrom}||'01' AND #{scPeriodFrom}||'12'
           		GROUP BY INTERFACE_ID, TR_MONTH
        	) ERROR
      		GROUP BY INTERFACE_ID
    		UNION ALL
    		SELECT
        		 INTERFACE_ID
         		, '2' AS SEQ
         		,'PROCESSING'  AS GUBUN
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'01' THEN TOTAL_CNT ELSE 0 END) AS MONTH1
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'02' THEN TOTAL_CNT ELSE 0 END) AS MONTH2
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'03' THEN TOTAL_CNT ELSE 0 END) AS MONTH3
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'04' THEN TOTAL_CNT ELSE 0 END) AS MONTH4
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'05' THEN TOTAL_CNT ELSE 0 END) AS MONTH5
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'06' THEN TOTAL_CNT ELSE 0 END) AS MONTH6
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'07' THEN TOTAL_CNT ELSE 0 END) AS MONTH7
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'08' THEN TOTAL_CNT ELSE 0 END) AS MONTH8
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'09' THEN TOTAL_CNT ELSE 0 END) AS MONTH9
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'10' THEN TOTAL_CNT ELSE 0 END) AS MONTH10
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'11' THEN TOTAL_CNT ELSE 0 END) AS MONTH11
         		, SUM(CASE WHEN RANGE1=CAST(#{scPeriodFrom} AS VARCHAR(4))||'12' THEN TOTAL_CNT ELSE 0 END) AS MONTH12
         		, SUM(TOTAL_CNT) AS YEAR_SUM
      		FROM (
        		SELECT
            		INTERFACE_ID
          			, TR_MONTH AS RANGE1
          			, SUM(COALESCE(PROCESS_CNT, 0)) AS TOTAL_CNT
          		FROM TSU0805
          		WHERE TR_MONTH BETWEEN #{scPeriodFrom}||'01' AND #{scPeriodFrom}||'12'
           		GROUP BY INTERFACE_ID, TR_MONTH
        	) PROCESSING
      		GROUP BY  INTERFACE_ID
      	) A
		<include refid="pep.per.mint.database.mapper.su.StatisticsMapperKICS.period-innerJoin-total-interface1"/>
		ORDER BY B.INTERFACE_ID, B.INTERFACE_NM, A.SEQ
	</select>

</mapper>